# MySQL default test configuration
auth:
  rootPassword: "testpassword123"
  database: "testdb"
  username: "testuser"
  password: "testuser123"

primary:
  resourcesPreset: "small"
  persistence:
    enabled: false
  # Init container to fix volume permissions
  initContainers:
    - name: volume-permissions
      image: ghcr.io/kubelauncher/mysql:8.0
      imagePullPolicy: IfNotPresent
      command: ["sh", "-c", "chmod -R 777 /data/mysql && chown -R 1001:1001 /data/mysql"]
      securityContext:
        runAsUser: 0
      volumeMounts:
        - name: data
          mountPath: /data/mysql
  # Increase startup probe timeout for slow init
  startupProbe:
    enabled: true
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 60
  # Run as mysql user after init container fixes permissions
  podSecurityContext:
    enabled: true
    fsGroup: 1001
  containerSecurityContext:
    enabled: true
    runAsUser: 1001
    runAsGroup: 1001
    runAsNonRoot: true
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: false
    capabilities:
      drop: ["ALL"]
    seccompProfile:
      type: RuntimeDefault
